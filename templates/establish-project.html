<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="Bookmark" href="favicon.ico">
    <link rel="Shortcut Icon" href="favicon.ico" />
    <!--[if lt IE 9]>
    <script type="text/javascript" src="lib/html5.js"></script>
    <script type="text/javascript" src="lib/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/static/static/h-ui/css/H-ui.min.css" />
    <link rel="stylesheet" type="text/css" href="/static/static/h-ui.admin.pro/css/h-ui.admin.pro.min.css" />
    <link rel="stylesheet" type="text/css" href="/static/lib/Hui-iconfont/1.0.8/iconfont.css" />
    <link rel="stylesheet" type="text/css" href="/static/static/h-ui.admin.pro/skin/default/skin.css" id="skin" />
    <link rel="stylesheet" type="text/css" href="/static/static/business/css/style.css" />
    {#	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">#}
    <!--[if IE 6]>
    {#	<script type="text/javascript" src="http://lib.h-ui.net/DD_belatedPNG_0.0.8a-min.js" ></script>#}
    <script>DD_belatedPNG.fix('*');</script><![endif]-->
    <!--/meta 作为公共模版分离出去-->
    <title>铁路隐私计算平台</title>
    <meta name="keywords" content="h-ui.admin.pro v1.0,H-ui网站后台模版,后台模版下载,后台管理系统模版,HTML后台模版下载">
    <meta name="description" content="h-ui.admin.pro v1.0，是一款由国人开发的轻量级扁平化网站后台模板，完全免费开源的网站后台管理系统模版，适合中小型CMS后台系统。">
    <style>
       .loader {
            border: 6px solid #f3f3f3;
            border-radius: 50%;
            border-top: 6px solid #3498db;
            width: 40px;
            height: 40px;
            -webkit-animation: spin 2s linear infinite; /* Safari */
            animation: spin 2s linear infinite;
        }

        /* Safari */
        @-webkit-keyframes spin {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

       .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0,0,0);
            background-color: rgba(0,0,0,0.4);
            padding-top: 60px;
        }

       .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 40%;
            right: 0;
        }

        /* 搜索功能样式 */
       .search-container {
            margin-bottom: 20px;
            padding: 10px;
            background-color: #f4f4f4;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

       .search-container label {
            margin-right: 10px;
            font-weight: bold;
        }

       .search-container input[type="text"],
       .search-container select {
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

       .search-container button {
            padding: 6px 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }

       .search-container button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
<style>
    #menu-guest .Hui-menu-title,
    #menu-guest .Hui-menu-item a {
        color: #FFFFFF !important;  /* 亮白色 */
        text-shadow: 0 1px 2px rgba(0,0,0,0.2); /* 增加文字对比度 */
    }

    #menu-data-confirmation .Hui-menu-title,
    #menu-data-confirmation .Hui-menu-item a {
        color: #FFFFFF !important;  /* 亮白色 */
        text-shadow: 0 1px 2px rgba(0,0,0,0.2); /* 增加文字对比度 */
    }
    </style>
    <!--_menu 作为公共模版分离出去-->
   <aside class="Hui-admin-aside-wrapper">
		<div class="Hui-admin-logo-wrapper">
			<a class="logo navbar-logo" href="/aboutHui.shtml">
				<i class="va-m iconpic global-logo"></i>
				<span class="va-m">可信数据空间</span>
			</a>
		</div>
		<div class="Hui-admin-menu-dropdown bk_2">
            <dl id="menu-guest" class="Hui-menu">
				<dt class="Hui-menu-title selected"><i class="Hui-iconfont">&#xe60d;</i> 用户管理<i class="Hui-iconfont Hui-admin-menu-dropdown-arrow">&#xe6d5;</i></dt>
				<dd class="Hui-menu-item" style="display:block">
					<ul>
						<li><a href="http://127.0.0.1:8000/user-list/" title="用户管理">用户管理</a></li>
					</ul>
				</dd>
			</dl>
            <dl id="menu-data-confirmation" class="Hui-menu">
              <dt class="Hui-menu-title"><i class="Hui-iconfont">&#xe616;</i> 数据确权<i class="Hui-iconfont Hui-admin-menu-dropdown-arrow">&#xe6d5;</i></dt>
              <dd class="Hui-menu-item" style="display:block">
                <ul>
                  <li><a href="http://127.0.0.1:8000/data-confirmation/" title="数据确权">数据确权</a></li>
                </ul>
              </dd>
            </dl>

            <dl id="menu-guest" class="Hui-menu">
				<dt class="Hui-menu-title selected"><i class="Hui-iconfont">&#xe60d;</i> 数据管理<i class="Hui-iconfont Hui-admin-menu-dropdown-arrow">&#xe6d5;</i></dt>
				<dd class="Hui-menu-item" style="display:block">
					<ul>
						<li><a href="http://127.0.0.1:8000/data_asset_list/" title="数据列表">数据列表</a></li>
					</ul>
				</dd>

			</dl>
             <dl id="menu-guest" class="Hui-menu">
                <dt class="Hui-menu-title selected"><i class="Hui-iconfont">&#xe60d;</i> 项目信息管理<i class="Hui-iconfont Hui-admin-menu-dropdown-arrow">&#xe6d5;</i></dt>
                <dd class="Hui-menu-item" style="display:block">
                    <ul>
                        <li class="current"><a href="http://127.0.0.1:8000/established_project/" title="已建立项目">已建立项目</a></li>
                    </ul>
                    <ul>
                        <li><a href="http://127.0.0.1:8000/pengding_project/" title="待接受项目">待接受项目</a></li>
                    </ul>
                </dd>
            </dl>
            <dl id="menu-guest" class="Hui-menu">
				<dt class="Hui-menu-title selected"><i class="Hui-iconfont">&#xe60d;</i> 存证信息管理<i class="Hui-iconfont Hui-admin-menu-dropdown-arrow">&#xe6d5;</i></dt>
				<dd class="Hui-menu-item" style="display:block">
					<ul>
						<li><a href="http://127.0.0.1:8000/records/" title="数据存证信息">数据存证信息</a></li>
					</ul>
				</dd>
                <dd class="Hui-menu-item" style="display:block">
					<ul>
						<li><a href="http://127.0.0.1:8000/project_notarization/" title="项目存证信息">项目存证信息</a></li>
					</ul>
				</dd>
			</dl>
            <dl id="menu-guest" class="Hui-menu">
				<dt class="Hui-menu-title selected"><i class="Hui-iconfont">&#xe60d;</i>数据安全共享方法<i class="Hui-iconfont Hui-admin-menu-dropdown-arrow">&#xe6d5;</i></dt>
                <dd class="Hui-menu-item" style="display:block">
					<ul>
						<li><a href="http://127.0.0.1:8000/wb-interface/" title="数据接口">数据接口</a></li>
					</ul>
				</dd>
                <dd class="Hui-menu-item" style="display:block">
					<ul>
						<li><a href="http://127.0.0.1:8000/sjsx-interface/" title="数据沙箱">数据沙箱</a></li>
					</ul>
				</dd>
				<dd class="Hui-menu-item" style="display:block">
					<ul>
						<li><a href="http://127.0.0.1:8000/guest-list/" title="隐私计算">隐私计算</a></li>
					</ul>
				</dd>
                <dd class="Hui-menu-item" style="display:block">
					<ul>
						<li><a href="http://127.0.0.1:8000/multguest-list/" title="密文计算">密文计算</a></li>
					</ul>
				</dd>
			</dl>
		</div>
	</aside>
    <div class="Hui-admin-aside-mask"></div>

    <div class="Hui-admin-dislpayArrow">
        <a href="javascript:void(0);" onClick="displaynavbar(this)">
            <i class="Hui-iconfont Hui-iconfont-left">&#xe6d4;</i>
            <i class="Hui-iconfont Hui-iconfont-right">&#xe6d7;</i>
        </a>
    </div>
    <section class="Hui-admin-article-wrapper">
        <!--_header 作为公共模版分离出去-->
        <header class="Hui-navbar">
            <div class="navbar">
                <div class="container-fluid clearfix">
                    <nav id="Hui-topNav" class="nav navbar-nav">
                        <ul class="clearfix">
                            <li class="dropDown dropDown_hover">
                                <ul class="dropDown-menu menu radius box-shadow">
                                    <li class="">
                                        <a href="#">二级导航</a>
                                    </li>
                                    <li class="">
                                        <a href="#">二级导航</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </nav>

                </div>
            </div>
        </header>
        <!--/_header 作为公共模版分离出去-->
        <div class="Hui-admin-article">
            <nav class="breadcrumb" style="background-color:#fff;padding: 0 24px">
                首页
                <span class="c-gray en">/</span>
                项目信息管理
                <span class="c-gray en">/</span>
                项目申请
            </nav>
      <article class="Hui-admin-content clearfix">
        <div class="panel mt-20">
          <div class="panel-body"发布>
            <div class="clearfix">
                <a href="javascript:;" onclick="project_add()" class="btn btn-primary radius"><i class="Hui-iconfont">&#xe600;</i> 项目申请</a>
                <a href="javascript:;" onclick="project_right()" class="btn btn-primary radius"><i class="Hui-iconfont">&#xe600;</i> 项目数据资产权申请</a>
                   <!-- 新增搜索区域 start -->
            <div class="search-container">
                    <label for="projectNameSearch">项目名称:</label>
                    <input type="text" id="projectNameSearch" placeholder="模糊搜索项目名称">
                    <label for="dataOwnerSearch">数据所有方:</label>
                    <select id="dataOwnerSearch">
                        <option value="">全部</option>
                        <option value="铁路">铁路</option>
                        <option value="海关">海关</option>
                        <option value="港口">港口</option>
                        <option value="哈方">哈方</option>
                    </select>
                    <label for="dataAssetSearch">所需数据资产:</label>
                    <input type="text" id="dataAssetSearch" placeholder="模糊搜索所需数据资产">
                    <label for="securityLevelSearch">数据安全等级:</label>
                    <select id="securityLevelSearch">
                        <option value="">全部</option>
                        <option value="低敏">低敏</option>
                        <option value="敏感">敏感</option>
                        <option value="高敏">高敏</option>
                        <option value="高敏密文">高敏密文</option>
                    </select>
                    <label for="statusSearch">申请状态:</label>
                    <select id="statusSearch">
                        <option value="">全部</option>
                        <option value="0">发起</option>
                        <option value="1">待审核</option>
                        <option value="2">审核通过</option>
                        <option value="3">审核不通过</option>
                        <option value="4">正在进行</option>
                        <option value="5">已完成</option>
                    </select>
                    <button type="button" onclick="searchProjects()">搜索</button>
                </span>
            </div>
            <!-- 新增搜索区域 end -->
            <div class="clearfix mt-20">
              <table class="table table-border table-bordered table-hover table-bg table-sort">
                <thead>
                  <tr class="text-c">
                    <th width="40">选择</th>
                    <th width="80">项目名称</th>
                    <th width="100">数据需求方</th>
                    <th width="90">数据所有方</th>
                    <th width="100">所需数据资产</th>
                    <th width="120">安全等级</th>
                    <th width="100">共享方式</th>
                    <th width="120">申请状态</th>
                    <th width="150">操作</th>
                  </tr>
                </thead>
                <tbody id="info">
                </tbody>
              </table>
            </div>

            <div id="myModal" class="modal">
              <!-- 模态框内容 -->
              <div class="modal-content">
                <p>模型预测中，请稍候...</p>
                <div class="loader"></div>
              </div>
            </div>
            <div id="myModal1" class="modal">
              <!-- 模态框内容 -->
              <div class="modal-content">
                <p>结果处理中，请稍候...</p>
                <div class="loader"></div>
              </div>
            </div>
          </div>
          </div>
        </div>
      </article>
    </div>
  </section>

    <!--_footer 作为公共模版分离出去-->
    <script type="text/javascript" src="/static/lib/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript" src="/static/lib/layer/2.4/layer.js"></script>
    <script type="text/javascript" src="/static/static/h-ui/js/H-ui.min.js"></script>
    <script type="text/javascript" src="/static/static/h-ui.admin.pro/js/h-ui.admin.pro.min.js"></script>
    <!--/_footer /作为公共模版分离出去-->

    <!--请在下方写此页面业务相关的脚本-->
    <script type="text/javascript" src="/static/lib/datatables/1.10.15/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="/static/lib/laypage/1.2/laypage.js"></script>
    <script type="text/javascript" src="/static/static/business/js/main.js"></script>
    <script type="text/javascript">
     var currentUser = {
              id:"{{current_user.id }}",
              account:"{{current_user.account }}",
              com:"{{current_user.com }}",
              comid:"{{ current_user.comid }}",
     };
        // 显示模态框
    function showModal() {
      document.getElementById('myModal').style.display = "block";
    }

    // 隐藏模态框
    function hideModal() {
      document.getElementById('myModal').style.display = "none";
    }

    function showModal1() {
      document.getElementById('myModal1').style.display = "block";
    }

    // 隐藏模态框
    function hideModal1() {
      document.getElementById('myModal1').style.display = "none";
    }

    // 新增搜索功能的函数
    function searchProjects() {
      var projectName = document.getElementById('projectNameSearch').value;
      var dataOwner = document.getElementById('dataOwnerSearch').value;
      var dataAsset = document.getElementById('dataAssetSearch').value;
      var securityLevel = document.getElementById('securityLevelSearch').value;
      var status = document.getElementById('statusSearch').value;

      $.ajax({
        type: "post",
        url: "http://127.0.0.1:8000/search_project_data/",
        dataType: 'json',
        data: {
          projectName: projectName,
          dataOwner: dataOwner,
          dataAsset: dataAsset,
          securityLevel: securityLevel,
          status: status
        },
        success: function (res) {
          console.log("res", res);
          if (res.status === "0") {
            var dataList = res.data;
            var tableBody = $('#info');
            tableBody.empty(); // 清空表格内容
            dataList.forEach(function (item) {
              var statusText = "";
              switch (item.currentStatus) {
                case '0':
                  statusText = "发起";
                  break;
                case '1':
                  statusText = "待审核";
                  break;
                case '2':
                  statusText = "审核通过";
                  break;
                case '3':
                  statusText = "审核不通过";
                  break;
                case '4':
                  statusText = "正在进行";
                  break;
                case '5':
                  statusText = "已完成";
                  break;
                default:
                  statusText = "未知状态";
              }


              var row = $('<tr class="text-c"></tr>');
              console.log("获取的id:", item.ID);

              // 添加单选列（所有radio使用相同的name实现单选）
              row.append(
                '<td>' +
                '<input type="radio" name="selectedProject">' +
                '</td>'
              );

              row.append('<td>' + item.projectName + '</td>');
              row.append('<td>' + item.dataDemand + '</td>');
              row.append('<td>' + item.dataOwner + '</td>');
              row.append('<td>' + item.dataAsset + '</td>');
              row.append('<td>' + item.dataSecurity + '</td>');
              row.append('<td><a href="javascript:;" ' + 'onclick="sharingTypeResultShow(\'' + item.shareWay + '\', \'' + encodeURIComponent(item.projectName) + '\', ' +  (item.isDataOwner? 0 : 1) + ')" ' +  'class="btn btn-primary radius">' +  '<i class="Hui-iconfont">&#xe600;</i> ' + item.shareWay + '</a></td>');
              row.append('<td>' + statusText + '</td>');
              // 使用 data-* 属性传递数据，包括项目 id
              var disabledClass = "";
              if (item.currentStatus!== '0' && item.currentStatus!== '1') {
                disabledClass = " disabled";
              }
              var actions = '<td>' +
                '<a title="修改" data-item=\'' + JSON.stringify(item) + '\' data-id="' + item.ID + '" onclick="project_edit(this)" class="btn' + disabledClass + '"><i class="Hui-iconfont">&#xe6df;</i></a> ' +
                '<a title="删除" onclick="project_delete(\'' + item.projectName + '\', \'' + item.dataDemand + '\', \'' + item.dataOwner + '\', \'' + item.dataAsset + '\')" class="btn' + disabledClass + '"><i class="Hui-iconfont">&#xe6e2;</i></a> ' +
                '<a title="提交" onclick="project_submit(\'' + item.ID + '\')" class="btn' + disabledClass + '"><i class="Hui-iconfont">&#xe600;</i></a>' +
                '</td>';
              row.append(actions);
              tableBody.append(row);
            });
          } else {
            alert(res.message);
          }
        },
        error: function (error) {
          console.error("请求失败:", error.status, error.statusText, error.responseText);
          alert("请求数据失败，请稍后重试");
        }
      });
    }

 $(function () {
      // 初始加载数据
      $.ajax({
        type: "post",
        url: "http://127.0.0.1:8000/get_project_data/",
        dataType: 'json',
        success: function (res) {
          console.log("res", res);
          if (res.status === "0") {
            var dataList = res.data;
            var tableBody = $('#info');
            dataList.forEach(function (item) {
              var statusText = "";
              switch (item.currentStatus) {
                case '0':
                  statusText = "发起";
                  break;
                case '1':
                  statusText = "待审核";
                  break;
                case '2':
                  statusText = "审核通过";
                  break;
                case '3':
                  statusText = "审核不通过";
                  break;
                case '4':
                  statusText = "正在进行";
                  break;
                case '5':
                  statusText = "已完成";
                  break;
                default:
                  statusText = "未知状态";
              }
              var row = $('<tr class="text-c"></tr>');
              console.log("获取的id:", item.ID);

              // 添加单选列（所有radio使用相同的name实现单选）
              row.append(
                '<td>' +
                '<input type="radio" name="selectedProject">' +
                '</td>'
              );

              row.append('<td>' + item.projectName + '</td>');
              row.append('<td>' + item.dataDemand + '</td>');
              row.append('<td>' + item.dataOwner + '</td>');
              row.append('<td>' + item.dataAsset + '</td>');
              row.append('<td>' + item.dataSecurity + '</td>');row.append('<td><a href="javascript:;" onclick="sharingTypeResultShow(\'' + item.shareWay + '\', \'' + item.dataOwner + '\', \'' + item.projectName + '\')" class="btn btn-primary radius"><i class="Hui-iconfont">&#xe600;</i> ' + item.shareWay + '</a></td>');
              row.append('<td>' + statusText + '</td>');
              // 使用 data-* 属性传递数据，包括项目 id
              var disabledClass = "";
              if (item.currentStatus!== '0' && item.currentStatus!== '1') {
                disabledClass = " disabled";
              }
             var actions = '<td>' +
                 '<a title="修改" data-item=\'' + JSON.stringify(item) + '\' data-id="' + item.ID + '" onclick="project_edit(this)" class="btn' + disabledClass + '"><i class="Hui-iconfont">&#xe6df;</i></a> ' +
                 '<a title="删除" onclick="project_delete(\'' + item.projectName + '\', \'' + item.dataDemand + '\', \'' + item.dataOwner + '\', \'' + item.dataAsset + '\', \'' + item.ID + '\')" class="btn' + disabledClass + '"><i class="Hui-iconfont">&#xe6e2;</i></a> ' +
                 '<a title="提交" onclick="project_submit(\'' + item.ID + '\')" class="btn' + disabledClass + '"><i class="Hui-iconfont">&#xe600;</i></a>' +
                 '</td>';
              row.append(actions);
              tableBody.append(row);
            });
          } else {
            alert(res.message);
          }
        },
        error: function (error) {
          console.error("请求失败:", error.status, error.statusText, error.responseText);
          alert("请求数据失败，请稍后重试");
        }
      });
    });

// 修改项目
    function project_edit(elem) {
      var disabled = $(elem).hasClass('disabled');
      if (disabled) {
        layer.msg('当前状态不允许修改', { icon: 2 });
        return;
      }
      var item = JSON.parse(elem.getAttribute('data-item'));
      var id = elem.getAttribute('data-id');
      console.log("id:", id);
      try {
        // 构建携带数据的 URL，包括项目 id
        var queryString = `id=${encodeURIComponent(id)}&project_name=${encodeURIComponent(item.projectName)}&data_demander=${encodeURIComponent(item.dataDemand)}&data_owner=${encodeURIComponent(item.dataOwner)}&data_asset=${encodeURIComponent(item.dataAsset)}&security_level=${encodeURIComponent(item.dataSecurity)}&trans_mode=${encodeURIComponent(item.shareWay)}`;
        var targetUrl = "http://127.0.0.1:8000/project_add/?" + queryString;
        console.log("跳转URL:", targetUrl);
        location.href = targetUrl;
      } catch (error) {
        console.error("JSON解析错误:", error);
        alert("解析数据时出现错误，请检查数据格式。");
      }
    }







        function project_add() {
            location.href = "http://127.0.0.1:8000/project_add/";
        }

         function project_right() {
            const selectedId = $('input[name="selectedProject"]:checked').val();
              if (!selectedId) {
                alert('请先选择项目');
                return;
              }

              const selectedRow = $('input[name="selectedProject"]:checked').closest('tr');
              const data = {
                projectName: selectedRow.find('td:eq(1)').text(),    // 项目名称
                demand: selectedRow.find('td:eq(2)').text(),    // 数据需求方
                owner: selectedRow.find('td:eq(3)').text(),     // 数据所有方
                asset: selectedRow.find('td:eq(4)').text()      // 所需数据资产
              };
              sessionStorage.setItem('selectedData', JSON.stringify(data));
              location.href = "http://127.0.0.1:8000/data-confirmation/apply/";
        }
       // 删除操作函数
    function project_delete(projectName, dataDemand, dataOwner, dataAsset, id) {
    var btn = document.querySelector('a[onclick="project_delete(\'' + projectName + '\', \'' + dataDemand + '\', \'' + dataOwner + '\', \'' + dataAsset + '\', \'' + id + '\')"]');
    var disabled = btn.classList.contains('disabled');
    if (disabled) {
        layer.msg('当前状态不允许删除', { icon: 2 });
        return;
    }
    layer.confirm('确认要删除吗？', function (index) {
        // 这里需要根据实际情况发送删除请求
        $.ajax({
            type: 'POST',
            url: 'http://127.0.0.1:8000/delete_project/', // 替换为实际的删除接口
            data: {
                projectName: projectName,
                dataDemand: dataDemand,
                dataOwner: dataOwner,
                dataAsset: dataAsset,
                id: id // 添加ID参数
            },
            success: function (res) {
                if (res.status === '0') {
                    layer.msg('删除成功', { icon: 1 });
                    // 刷新页面或重新加载数据
                    location.reload();
                } else {
                    layer.msg('删除失败：' + res.message, { icon: 2 });
                }
            },
            error: function (error) {
                console.error("删除请求失败:", error.status, error.statusText, error.responseText);
                layer.msg('删除请求失败，请稍后重试', { icon: 2 });
            }
        });
        layer.close(index);
    });
}

// 提交操作函数
    function project_submit(id) {
      var btn = document.querySelector('a[onclick="project_submit(\'' + id + '\')"]');
      var disabled = btn.classList.contains('disabled');
      if (disabled) {
        layer.msg('当前状态不允许提交', { icon: 2 });
        return;
      }
      layer.confirm('确认要提交吗？', function (index) {
        // 这里需要根据实际情况发送提交请求
        $.ajax({
          type: 'POST',
          url: 'http://127.0.0.1:8000/submit_project/', // 替换为实际的提交接口
          data: { id: id, currentStatus: 1 }, // 添加 currentStatus 参数并设置为 1
          success: function (res) {
            if (res.status === '0') {
              layer.msg('提交成功', { icon: 1 });
              // 刷新页面或重新加载数据
              location.reload();
            } else {
              layer.msg('提交失败：' + res.message, { icon: 2 });
            }
          },
          error: function (error) {
            console.error("提交请求失败:", error.status, error.statusText, error.responseText);
            layer.msg('提交请求失败，请稍后重试', { icon: 2 });
          }
        });
        layer.close(index);
    });
}
// 新增共享方式跳转函数
function sharingTypeResultShow(shareType, dataOwner,projectName) {
    // 定义合法的共享方式列表
    const validShareTypes = {
        '接口交换': 'http://127.0.0.1:8000/wb-interface/',
        '安全沙箱': 'http://127.0.0.1:8000/sjsx-interface/',
        '隐私计算': 'http://127.0.0.1:8000/guest-list/',
        '密文计算': 'http://127.0.0.1:8000/multguest-list/'
    };
    // 参数校验
    if (!shareType) {
        layer.msg('共享方式参数不能为空', {icon: 2});
        return;
    }
    // 严格类型校验
    if (typeof shareType !== 'string') {
        console.error('非法参数类型:', typeof shareType);
        layer.msg('参数类型错误', {icon: 2});
        return;
    }
    // 有效性校验
    if (!(shareType in validShareTypes)) {
        console.warn('非法的共享方式:', shareType);
        layer.msg(`不支持的共享方式：${shareType}`, {icon: 2});
        return;
    }
     // 判断当前用户是否为数据所有方
    const isDataOwner = currentUser.com === dataOwner; // 根据实际业务逻辑修改判断条件
    const targetId = isDataOwner ? '1' : '0'; // 数据所有方传1，否则传0
    console.log("targetId:", targetId);
    console.log(dataOwner)
    console.log(currentUser.com)
    if (shareType === '接口交换')
        // 存储到sessionStorage
    {sessionStorage.setItem('target_id', targetId);
        sessionStorage.setItem('project_name', projectName);}
    if (shareType === '安全沙箱')
        // 存储到sessionStorage
    {sessionStorage.setItem('target_id', targetId);
        sessionStorage.setItem('project_name', projectName);}

    // 获取对应的URL
    const url = validShareTypes[shareType];
    try {
        // 打开新窗口
        location.href=url
    } catch (e) {
        console.error('打开链接失败:', e);
        layer.msg('链接打开失败，请联系管理员', {icon: 2});
    }
}
//打印当前用户信息到控制台（用于调试）
   console.Log("当前用户ID:",currentUser,id);
  console.Log("当前用户所属方：",currentUser.com);

    </script>
    <!--/请在上方写此页面业务相关的脚本-->
</body>
</html>
